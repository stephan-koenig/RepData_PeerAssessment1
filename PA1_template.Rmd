---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r loadPackages, echo=FALSE, results='hide', message=FALSE}
# Load all required packages installing any that are missing.
requiredPackages <- c("dplyr", "ggplot2")
missingPackages <- !is.element(requiredPackages, installed.packages()[,1])
missingPackages <- requiredPackages[missingPackages]
if (length(missingPackages) != 0) install.packages(missingPackages)
lapply(requiredPackages, library, character.only = TRUE)
rm(requiredPackages, missingPackages)
```

## Loading and preprocessing the data
```{r loadData, echo=FALSE}
# Time when copy of activity.zip in this fork was downloaded.
dateDownloaded <- "Sat Jan 23 22:13:46 2016"

# Download data if not present and update time when the copy was downloaded.
if (!file.exists("activity.zip") && !file.exists("activity.csv")) {
    
    url = paste("https://d396qusza40orc.cloudfront.net/",
                "repdata%2Fdata%2Factivity.zip", sep = "")
    
    # Determine download.file method based on OS.
    if (.Platform$OS.type == "unix") {
        osMethod = "libcurl"
    } else {
        osMethod = "wininet"
    }
    
    download.file(url, "activity.zip", method = osMethod)
    dateDownloaded <- date()
    rm(url, osMethod)
}

# If .csv data file is not present if not unzip activity.zip
if (!file.exists("activity.csv")) {
    unzip("activity.zip")
}

# Load .csv file as data frame table
activity <- tbl_df(read.csv("activity.csv"))
```
File downloaded on: `r dateDownloaded`

## What is mean total number of steps taken per day?
```{r dailyActivity}
# Discard row with NAs, group by day, and calculate total steps per day.
dailyActivity <- na.omit(activity) %>% group_by(date) %>%
    summarize(totalSteps = sum(steps))
```

```{r histogramSteps, echo=FALSE}
# Make a histogram of the total number of steps taken each day.
# Determine optimal bin number and corresponding breaks for histogram using
# the Freedman-Diaconis rule.
binNumber <- nclass.FD(dailyActivity$totalSteps)
binBreaks <- seq(min(dailyActivity$totalSteps),
                 max(dailyActivity$totalSteps),
                 length.out = binNumber + 1)

# Construct histogram
ggplot(dailyActivity) +
    geom_histogram(aes(totalSteps, ..count../sum(..count..) * 100),
                   origin = min(dailyActivity$totalSteps),
                   breaks = binBreaks,
                   col = "black",
                   fill= "grey") +
    scale_x_continuous(breaks = round(binBreaks)) +
    ggtitle("Normalized Histogram of Total Steps Per Day") +
    xlab("total steps per day") +
    ylab("percent of days [%]")
```


```{r meanMedianCalc, echo=FALSE}
# Calculate mean and median of the total steps taken per day
meanSteps <- mean(dailyActivity$totalSteps)
medianSteps <- median(dailyActivity$totalSteps)
```

The mean is `r format(meanSteps, digits = 7)` and the median is `r medianSteps`
for total number of steps taken per day.

## What is the average daily activity pattern?
```{r}
intervalActivity <- na.omit(activity) %>% group_by(interval) %>%
    summarize(meanSteps = mean(steps))
```


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
